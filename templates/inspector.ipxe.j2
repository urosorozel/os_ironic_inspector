#!ipxe

:retry_boot
echo In inspector.ipxe
imgfree
# NOTE(dtantsur): keep inspection kernel params in [mdns]params in ironic-inspector-image
kernel --timeout 60000 http://{{ hostvars[inventory_hostname]['ansible_' + ironic_inspector_dhcp_interface|replace("-","_")]['ipv4']['address'] }}:{{ ironic_inspector_webfsd_port }}/ipa_kernel ipa-inspection-callback-url=http://{{ hostvars[inventory_hostname]['ansible_' + ironic_inspector_dhcp_interface|replace("-","_")]['ipv4']['address'] }}:5050/v1/continue ipa-inspection-collectors=default,extra-hardware,logs systemd.journald.forward_to_console=yes BOOTIF=${mac:hexhyp} ipa-debug=1 ipa-inspection-dhcp-all-interfaces=1 ipa-collect-lldp=1 initrd=ipa_ramdisk || goto retry_boot
initrd --timeout 60000 http://{{ hostvars[inventory_hostname]['ansible_' + ironic_inspector_dhcp_interface|replace("-","_")]['ipv4']['address'] }}:{{ ironic_inspector_webfsd_port }}/ipa_ramdisk || goto retry_boot
boot
